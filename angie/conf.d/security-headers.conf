# ===========================================
# FaithTracker - Security Headers (OWASP)
# ===========================================
# These headers implement OWASP security recommendations
# Migrated from Traefik middleware configuration
#
# Reference: https://owasp.org/www-project-secure-headers/

# ===================
# Strict-Transport-Security (HSTS)
# ===================
# Forces HTTPS for 1 year, includes subdomains, allows preload
# IMPORTANT: Only enable preload if you're sure ALL subdomains support HTTPS
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;

# ===================
# X-Frame-Options
# ===================
# Prevents clickjacking by disallowing framing
# Use SAMEORIGIN if you need to embed in same-origin iframes
add_header X-Frame-Options "DENY" always;

# ===================
# X-Content-Type-Options
# ===================
# Prevents MIME-type sniffing attacks
add_header X-Content-Type-Options "nosniff" always;

# ===================
# X-XSS-Protection
# ===================
# Legacy XSS protection (for older browsers)
# Modern browsers use CSP instead
add_header X-XSS-Protection "1; mode=block" always;

# ===================
# Referrer-Policy
# ===================
# Controls how much referrer information is sent
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

# ===================
# Permissions-Policy (formerly Feature-Policy)
# ===================
# Restricts access to browser features
add_header Permissions-Policy "geolocation=(), microphone=(), camera=(), payment=(), usb=(), magnetometer=(), gyroscope=(), accelerometer=()" always;

# ===================
# X-Robots-Tag
# ===================
# Prevents search engine indexing (for private app)
add_header X-Robots-Tag "noindex, nofollow, nosnippet, noarchive, notranslate, noimageindex" always;

# ===================
# X-Download-Options
# ===================
# Prevents IE from opening downloads directly
add_header X-Download-Options "noopen" always;

# ===================
# X-Permitted-Cross-Domain-Policies
# ===================
# Restricts Adobe Flash/Acrobat cross-domain policies
add_header X-Permitted-Cross-Domain-Policies "none" always;

# ===================
# Cross-Origin Headers
# ===================
# Isolates browsing context (recommended for modern browsers)
# These may cause issues with some third-party integrations
# add_header Cross-Origin-Embedder-Policy "require-corp" always;
# add_header Cross-Origin-Opener-Policy "same-origin" always;
# add_header Cross-Origin-Resource-Policy "same-origin" always;

# ===================
# Notes
# ===================
# Content-Security-Policy (CSP) is set per-location in faithtracker.conf
# because frontend and API have different requirements.
#
# To test headers:
#   curl -I https://yourdomain.com
#   https://securityheaders.com
